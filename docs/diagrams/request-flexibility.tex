\newgeometry{textwidth=0.9\paperwidth}
\begin{figure}
    \resizebox{\textwidth}{!}{%
        % generated by Plantuml 1.2022.7
        \definecolor{plantucolor0000}{RGB}{255,250,240}
        \definecolor{plantucolor0001}{RGB}{24,24,24}
        \definecolor{plantucolor0002}{RGB}{0,0,0}
        \definecolor{plantucolor0003}{RGB}{248,248,255}
        \definecolor{plantucolor0004}{RGB}{245,245,245}
        \definecolor{plantucolor0005}{RGB}{255,255,255}
        \definecolor{plantucolor0006}{RGB}{254,255,221}
        \begin{tikzpicture}[yscale=-1
                ,pstyle3/.style={color=plantucolor0001,fill=white,line width=1.0pt}
                ,pstyle4/.style={color=plantucolor0001,line width=0.5pt,dash pattern=on 5.0pt off 5.0pt}
                ,pstyle5/.style={fill=plantucolor0000,color=plantucolor0000,line width=0.5pt}
                ,pstyle6/.style={fill=plantucolor0003,color=plantucolor0003,line width=0.5pt}
                ,pstyle7/.style={fill=plantucolor0004,color=plantucolor0004,line width=0.5pt}
                ,pstyle8/.style={color=plantucolor0001,fill=plantucolor0001,line width=1.0pt}
                ,pstyle9/.style={color=plantucolor0001,line width=1.0pt,dash pattern=on 2.0pt off 2.0pt}
                ,pstyle10/.style={color=plantucolor0001,line width=1.0pt}
                ,pstyle11/.style={color=plantucolor0001,fill=plantucolor0006,line width=0.5pt}
                ,pstyle12/.style={color=black,line width=1.0pt}
            ]
            \draw[color=plantucolor0001,fill=plantucolor0000,line width=0.5pt] (80.1693pt,6pt) rectangle (195.6022pt,551.7129pt);
            \node at (108.8122pt,6pt)[below right,color=black]{\textbf{Frontend}};
            \draw[color=plantucolor0001,fill=plantucolor0003,line width=0.5pt] (233.8799pt,6pt) rectangle (543.2955pt,551.7129pt);
            \node at (360.7877pt,6pt)[below right,color=black]{\textbf{Backend}};
            \draw[color=plantucolor0001,fill=plantucolor0004,line width=0.5pt] (585.4922pt,6pt) rectangle (672.1831pt,551.7129pt);
            \node at (592.1805pt,6pt)[below right,color=black]{\textbf{Blockchain}};
            \draw[pstyle3] (132.8857pt,108.1816pt) rectangle (142.8857pt,497.9668pt);
            \draw[pstyle3] (279.6857pt,251.5742pt) rectangle (289.6857pt,497.9668pt);
            \draw[pstyle3] (402.5685pt,356.0098pt) rectangle (412.5685pt,378.6764pt);
            \draw[pstyle3] (489.6542pt,325.5313pt) rectangle (499.6542pt,431.8216pt);
            \draw[pstyle4] (137.1693pt,59.2246pt) -- (137.1693pt,515.9668pt);
            \draw[pstyle4] (283.8799pt,59.2246pt) -- (283.8799pt,515.9668pt);
            \draw[pstyle4] (407.124pt,59.2246pt) -- (407.124pt,515.9668pt);
            \draw[pstyle4] (494.0129pt,59.2246pt) -- (494.0129pt,515.9668pt);
            \draw[pstyle4] (628.4922pt,59.2246pt) -- (628.4922pt,515.9668pt);
            \draw[pstyle5] (84.1693pt,31.4785pt) arc (180:270:5pt) -- (89.1693pt,26.4785pt) -- (186.6022pt,26.4785pt) arc (270:360:5pt) -- (191.6022pt,31.4785pt) -- (191.6022pt,53.2246pt) arc (0:90:5pt) -- (186.6022pt,58.2246pt) -- (89.1693pt,58.2246pt) arc (90:180:5pt) -- (84.1693pt,53.2246pt) -- cycle;
            \node at (91.1693pt,33.4785pt)[below right,color=black]{Event Handler};
            \draw[pstyle5] (84.1693pt,519.9668pt) arc (180:270:5pt) -- (89.1693pt,514.9668pt) -- (186.6022pt,514.9668pt) arc (270:360:5pt) -- (191.6022pt,519.9668pt) -- (191.6022pt,541.7129pt) arc (0:90:5pt) -- (186.6022pt,546.7129pt) -- (89.1693pt,546.7129pt) arc (90:180:5pt) -- (84.1693pt,541.7129pt) -- cycle;
            \node at (91.1693pt,521.9668pt)[below right,color=black]{Event Handler};
            \draw[pstyle6] (237.8799pt,31.4785pt) arc (180:270:5pt) -- (242.8799pt,26.4785pt) -- (326.4915pt,26.4785pt) arc (270:360:5pt) -- (331.4915pt,31.4785pt) -- (331.4915pt,53.2246pt) arc (0:90:5pt) -- (326.4915pt,58.2246pt) -- (242.8799pt,58.2246pt) arc (90:180:5pt) -- (237.8799pt,53.2246pt) -- cycle;
            \node at (244.8799pt,33.4785pt)[below right,color=black]{IPC Handler};
            \draw[pstyle6] (237.8799pt,519.9668pt) arc (180:270:5pt) -- (242.8799pt,514.9668pt) -- (326.4915pt,514.9668pt) arc (270:360:5pt) -- (331.4915pt,519.9668pt) -- (331.4915pt,541.7129pt) arc (0:90:5pt) -- (326.4915pt,546.7129pt) -- (242.8799pt,546.7129pt) arc (90:180:5pt) -- (237.8799pt,541.7129pt) -- cycle;
            \node at (244.8799pt,521.9668pt)[below right,color=black]{IPC Handler};
            \draw[pstyle6] (375.124pt,31.4785pt) arc (180:270:5pt) -- (380.124pt,26.4785pt) -- (435.0129pt,26.4785pt) arc (270:360:5pt) -- (440.0129pt,31.4785pt) -- (440.0129pt,53.2246pt) arc (0:90:5pt) -- (435.0129pt,58.2246pt) -- (380.124pt,58.2246pt) arc (90:180:5pt) -- (375.124pt,53.2246pt) -- cycle;
            \node at (382.124pt,33.4785pt)[below right,color=black]{Tracker};
            \draw[pstyle6] (375.124pt,519.9668pt) arc (180:270:5pt) -- (380.124pt,514.9668pt) -- (435.0129pt,514.9668pt) arc (270:360:5pt) -- (440.0129pt,519.9668pt) -- (440.0129pt,541.7129pt) arc (0:90:5pt) -- (435.0129pt,546.7129pt) -- (380.124pt,546.7129pt) arc (90:180:5pt) -- (375.124pt,541.7129pt) -- cycle;
            \node at (382.124pt,521.9668pt)[below right,color=black]{Tracker};
            \draw[pstyle6] (450.0129pt,31.4785pt) arc (180:270:5pt) -- (455.0129pt,26.4785pt) -- (534.2955pt,26.4785pt) arc (270:360:5pt) -- (539.2955pt,31.4785pt) -- (539.2955pt,53.2246pt) arc (0:90:5pt) -- (534.2955pt,58.2246pt) -- (455.0129pt,58.2246pt) arc (90:180:5pt) -- (450.0129pt,53.2246pt) -- cycle;
            \node at (457.0129pt,33.4785pt)[below right,color=black]{Aggregator};
            \draw[pstyle6] (450.0129pt,519.9668pt) arc (180:270:5pt) -- (455.0129pt,514.9668pt) -- (534.2955pt,514.9668pt) arc (270:360:5pt) -- (539.2955pt,519.9668pt) -- (539.2955pt,541.7129pt) arc (0:90:5pt) -- (534.2955pt,546.7129pt) -- (455.0129pt,546.7129pt) arc (90:180:5pt) -- (450.0129pt,541.7129pt) -- cycle;
            \node at (457.0129pt,521.9668pt)[below right,color=black]{Aggregator};
            \draw[pstyle7] (589.4922pt,31.4785pt) arc (180:270:5pt) -- (594.4922pt,26.4785pt) -- (663.1831pt,26.4785pt) arc (270:360:5pt) -- (668.1831pt,31.4785pt) -- (668.1831pt,53.2246pt) arc (0:90:5pt) -- (663.1831pt,58.2246pt) -- (594.4922pt,58.2246pt) arc (90:180:5pt) -- (589.4922pt,53.2246pt) -- cycle;
            \node at (596.4922pt,33.4785pt)[below right,color=black]{EW chain};
            \draw[pstyle7] (589.4922pt,519.9668pt) arc (180:270:5pt) -- (594.4922pt,514.9668pt) -- (663.1831pt,514.9668pt) arc (270:360:5pt) -- (668.1831pt,519.9668pt) -- (668.1831pt,541.7129pt) arc (0:90:5pt) -- (663.1831pt,546.7129pt) -- (594.4922pt,546.7129pt) arc (90:180:5pt) -- (589.4922pt,541.7129pt) -- cycle;
            \node at (596.4922pt,521.9668pt)[below right,color=black]{EW chain};
            \draw[pstyle3] (132.8857pt,108.1816pt) rectangle (142.8857pt,497.9668pt);
            \draw[pstyle3] (279.6857pt,251.5742pt) rectangle (289.6857pt,497.9668pt);
            \draw[pstyle3] (402.5685pt,356.0098pt) rectangle (412.5685pt,378.6764pt);
            \draw[pstyle3] (489.6542pt,325.5313pt) rectangle (499.6542pt,431.8216pt);
            \draw[pstyle8] (120.8857pt,104.1816pt) -- (130.8857pt,108.1816pt) -- (120.8857pt,112.1816pt) -- (124.8857pt,108.1816pt) -- cycle;
            \draw[pstyle9] (0pt,108.1816pt) -- (126.8857pt,108.1816pt);
            \node at (9.5pt,73.2246pt)[below right,color=black]{Request flexibility };
            \node at (30.5476pt,89.7031pt)[below right,color=black]{button click};
            \draw[pstyle10] (142.8857pt,138.6602pt) -- (184.8857pt,138.6602pt);
            \draw[pstyle10] (184.8857pt,138.6602pt) -- (184.8857pt,151.6602pt);
            \draw[pstyle10] (143.8857pt,151.6602pt) -- (184.8857pt,151.6602pt);
            \draw[pstyle8] (153.8857pt,147.6602pt) -- (143.8857pt,151.6602pt) -- (153.8857pt,155.6602pt) -- (149.8857pt,151.6602pt) -- cycle;
            \node at (149.8857pt,120.1816pt)[below right,color=black]{\textit{onFlexibilityRequest}};
            \draw[pstyle11] (63pt,164.6602pt) -- (63pt,223.6602pt) -- (211pt,223.6602pt) -- (211pt,174.6602pt) -- (201pt,164.6602pt) -- (63pt,164.6602pt);
            \draw[pstyle11] (201pt,164.6602pt) -- (201pt,174.6602pt) -- (211pt,174.6602pt) -- (201pt,164.6602pt);
            \node at (78.1076pt,169.6602pt)[below right,color=black]{Get the parameters };
            \node at (78pt,186.1387pt)[below right,color=black]{of the request from };
            \node at (106.0078pt,202.6172pt)[below right,color=black]{user input};
            \draw[pstyle8] (267.6857pt,247.5742pt) -- (277.6857pt,251.5742pt) -- (267.6857pt,255.5742pt) -- (271.6857pt,251.5742pt) -- cycle;
            \draw[pstyle10] (142.8857pt,251.5742pt) -- (273.6857pt,251.5742pt);
            \node at (160.6857pt,233.0957pt)[below right,color=black]{\textit{flexibilityRequest}};
            \draw[pstyle10] (289.6857pt,282.0527pt) -- (331.6857pt,282.0527pt);
            \draw[pstyle10] (331.6857pt,282.0527pt) -- (331.6857pt,295.0527pt);
            \draw[pstyle10] (290.6857pt,295.0527pt) -- (331.6857pt,295.0527pt);
            \draw[pstyle8] (300.6857pt,291.0527pt) -- (290.6857pt,295.0527pt) -- (300.6857pt,299.0527pt) -- (296.6857pt,295.0527pt) -- cycle;
            \node at (296.6857pt,263.5742pt)[below right,color=black]{\textit{startOnLoading}};
            \draw[pstyle8] (477.6542pt,321.5313pt) -- (487.6542pt,325.5313pt) -- (477.6542pt,329.5313pt) -- (481.6542pt,325.5313pt) -- cycle;
            \draw[pstyle10] (289.6857pt,325.5313pt) -- (483.6542pt,325.5313pt);
            \node at (337.0782pt,307.0527pt)[below right,color=black]{\textit{requestFlexibility}};
            \draw[pstyle8] (423.5685pt,352.0098pt) -- (413.5685pt,356.0098pt) -- (423.5685pt,360.0098pt) -- (419.5685pt,356.0098pt) -- cycle;
            \draw[pstyle10] (417.5685pt,356.0098pt) -- (488.6542pt,356.0098pt);
            \node at (427.2568pt,337.5313pt)[below right,color=black]{\textit{activate}};
            \draw[pstyle8] (477.6542pt,374.6764pt) -- (487.6542pt,378.6764pt) -- (477.6542pt,382.6764pt) -- (481.6542pt,378.6764pt) -- cycle;
            \draw[pstyle9] (407.5685pt,378.6764pt) -- (483.6542pt,378.6764pt);
            \draw[pstyle12] (451.2222pt,368.0098pt) -- (450.4747pt,368.7898pt) -- (447.463pt,371.8014pt) -- (446.5855pt,370.9564pt) -- (445.8055pt,370.1764pt) -- (444.278pt,371.7039pt) -- (445.058pt,372.4839pt) -- (446.683pt,374.1089pt) -- (447.4305pt,374.8889pt) -- (448.2105pt,374.1089pt) -- (452.0022pt,370.3173pt) -- (452.7822pt,369.5373pt) -- (451.2222pt,368.0098pt);
            \draw[pstyle8] (616.8377pt,405.1549pt) -- (626.8377pt,409.1549pt) -- (616.8377pt,413.1549pt) -- (620.8377pt,409.1549pt) -- cycle;
            \draw[pstyle10] (499.6542pt,409.1549pt) -- (622.8377pt,409.1549pt);
            \node at (511.6542pt,390.6764pt)[below right,color=black]{\textit{requestFlexibility}};
            \draw[pstyle8] (300.6857pt,427.8216pt) -- (290.6857pt,431.8216pt) -- (300.6857pt,435.8216pt) -- (296.6857pt,431.8216pt) -- cycle;
            \draw[pstyle9] (294.6857pt,431.8216pt) -- (493.6542pt,431.8216pt);
            \draw[pstyle12] (394.7808pt,421.1549pt) -- (394.0333pt,421.9349pt) -- (391.0216pt,424.9466pt) -- (390.1441pt,424.1016pt) -- (389.3641pt,423.3216pt) -- (387.8366pt,424.8491pt) -- (388.6166pt,425.6291pt) -- (390.2416pt,427.2541pt) -- (390.9891pt,428.0341pt) -- (391.7691pt,427.2541pt) -- (395.5608pt,423.4624pt) -- (396.3408pt,422.6824pt) -- (394.7808pt,421.1549pt);
            \draw[pstyle10] (289.6857pt,462.3001pt) -- (331.6857pt,462.3001pt);
            \draw[pstyle10] (331.6857pt,462.3001pt) -- (331.6857pt,475.3001pt);
            \draw[pstyle10] (290.6857pt,475.3001pt) -- (331.6857pt,475.3001pt);
            \draw[pstyle8] (300.6857pt,471.3001pt) -- (290.6857pt,475.3001pt) -- (300.6857pt,479.3001pt) -- (296.6857pt,475.3001pt) -- cycle;
            \node at (296.6857pt,443.8216pt)[below right,color=black]{\textit{onStopLoading}};
            \draw[pstyle8] (148.8857pt,493.9668pt) -- (138.8857pt,497.9668pt) -- (148.8857pt,501.9668pt) -- (144.8857pt,497.9668pt) -- cycle;
            \draw[pstyle9] (142.8857pt,497.9668pt) -- (283.6857pt,497.9668pt);
            \draw[pstyle12] (213.8965pt,487.3001pt) -- (213.149pt,488.0801pt) -- (210.1374pt,491.0918pt) -- (209.2599pt,490.2468pt) -- (208.4799pt,489.4668pt) -- (206.9524pt,490.9943pt) -- (207.7324pt,491.7743pt) -- (209.3574pt,493.3993pt) -- (210.1049pt,494.1793pt) -- (210.8849pt,493.3993pt) -- (214.6765pt,489.6076pt) -- (215.4565pt,488.8276pt) -- (213.8965pt,487.3001pt);
        \end{tikzpicture}
    }
    \caption{Diagramma di sequenza che descrive il momento di richiesta di flessibilità} \label{dg:request-flexibility}
\end{figure}
\restoregeometry