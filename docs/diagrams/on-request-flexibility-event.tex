\newgeometry{textwidth=0.9\paperwidth}
\begin{figure}
    \resizebox{!}{0.45\textheight}{%
        % generated by Plantuml 1.2022.7
        \definecolor{plantucolor0000}{RGB}{248,248,255}
        \definecolor{plantucolor0001}{RGB}{24,24,24}
        \definecolor{plantucolor0002}{RGB}{0,0,0}
        \definecolor{plantucolor0003}{RGB}{245,245,245}
        \definecolor{plantucolor0004}{RGB}{255,255,255}
        \definecolor{plantucolor0005}{RGB}{254,255,221}
        \begin{tikzpicture}[yscale=-1
                ,pstyle2/.style={color=plantucolor0001,fill=white,line width=1.0pt}
                ,pstyle3/.style={color=plantucolor0001,line width=0.5pt,dash pattern=on 5.0pt off 5.0pt}
                ,pstyle4/.style={fill=plantucolor0000,color=plantucolor0000,line width=0.5pt}
                ,pstyle5/.style={fill=plantucolor0003,color=plantucolor0003,line width=0.5pt}
                ,pstyle6/.style={color=plantucolor0001,fill=plantucolor0001,line width=1.0pt}
                ,pstyle7/.style={color=plantucolor0001,line width=1.0pt}
                ,pstyle8/.style={color=plantucolor0001,fill=plantucolor0005,line width=0.5pt}
            ]
            \draw[color=plantucolor0001,fill=plantucolor0000,line width=0.5pt] (61pt,6pt) rectangle (122.6pt,321.3203pt);
            \node at (64pt,6pt)[below right,color=black]{\textbf{Backend}};
            \draw[color=plantucolor0001,fill=plantucolor0003,line width=0.5pt] (232.3855pt,6pt) rectangle (319.0764pt,321.3203pt);
            \node at (239.0738pt,6pt)[below right,color=black]{\textbf{Blockchain}};
            \draw[pstyle2] (86.8pt,91.7031pt) rectangle (96.8pt,158.1816pt);
            \draw[pstyle2] (91.8pt,130.1816pt) rectangle (101.8pt,158.1816pt);
            \draw[pstyle3] (91.581pt,59.2246pt) -- (91.581pt,285.5742pt);
            \draw[pstyle3] (275.3855pt,59.2246pt) -- (275.3855pt,285.5742pt);
            \draw[pstyle4] (72.581pt,31.4785pt) arc (180:270:5pt) -- (77.581pt,26.4785pt) -- (106.019pt,26.4785pt) arc (270:360:5pt) -- (111.019pt,31.4785pt) -- (111.019pt,53.2246pt) arc (0:90:5pt) -- (106.019pt,58.2246pt) -- (77.581pt,58.2246pt) arc (90:180:5pt) -- (72.581pt,53.2246pt) -- cycle;
            \node at (79.581pt,33.4785pt)[below right,color=black]{IoT};
            \draw[pstyle4] (72.581pt,289.5742pt) arc (180:270:5pt) -- (77.581pt,284.5742pt) -- (106.019pt,284.5742pt) arc (270:360:5pt) -- (111.019pt,289.5742pt) -- (111.019pt,311.3203pt) arc (0:90:5pt) -- (106.019pt,316.3203pt) -- (77.581pt,316.3203pt) arc (90:180:5pt) -- (72.581pt,311.3203pt) -- cycle;
            \node at (79.581pt,291.5742pt)[below right,color=black]{IoT};
            \draw[pstyle5] (236.3855pt,31.4785pt) arc (180:270:5pt) -- (241.3855pt,26.4785pt) -- (310.0764pt,26.4785pt) arc (270:360:5pt) -- (315.0764pt,31.4785pt) -- (315.0764pt,53.2246pt) arc (0:90:5pt) -- (310.0764pt,58.2246pt) -- (241.3855pt,58.2246pt) arc (90:180:5pt) -- (236.3855pt,53.2246pt) -- cycle;
            \node at (243.3855pt,33.4785pt)[below right,color=black]{EW chain};
            \draw[pstyle5] (236.3855pt,289.5742pt) arc (180:270:5pt) -- (241.3855pt,284.5742pt) -- (310.0764pt,284.5742pt) arc (270:360:5pt) -- (315.0764pt,289.5742pt) -- (315.0764pt,311.3203pt) arc (0:90:5pt) -- (310.0764pt,316.3203pt) -- (241.3855pt,316.3203pt) arc (90:180:5pt) -- (236.3855pt,311.3203pt) -- cycle;
            \node at (243.3855pt,291.5742pt)[below right,color=black]{EW chain};
            \draw[pstyle2] (86.8pt,91.7031pt) rectangle (96.8pt,158.1816pt);
            \draw[pstyle2] (91.8pt,130.1816pt) rectangle (101.8pt,158.1816pt);
            \draw[pstyle6] (107.8pt,87.7031pt) -- (97.8pt,91.7031pt) -- (107.8pt,95.7031pt) -- (103.8pt,91.7031pt) -- cycle;
            \draw[pstyle7] (101.8pt,91.7031pt) -- (274.731pt,91.7031pt);
            \node at (110.0905pt,73.2246pt)[below right,color=black]{\textbf{RequestFlexibilityEvent}};
            \draw[pstyle7] (101.8pt,122.1816pt) -- (143.8pt,122.1816pt);
            \draw[pstyle7] (143.8pt,122.1816pt) -- (143.8pt,135.1816pt);
            \draw[pstyle7] (102.8pt,135.1816pt) -- (143.8pt,135.1816pt);
            \draw[pstyle6] (112.8pt,131.1816pt) -- (102.8pt,135.1816pt) -- (112.8pt,139.1816pt) -- (108.8pt,135.1816pt) -- cycle;
            \node at (108.8pt,103.7031pt)[below right,color=black]{\textit{provideFlexibility}};
            \draw[pstyle8] (5pt,178.1816pt) -- (5pt,270.1816pt) -- (179pt,270.1816pt) -- (179pt,188.1816pt) -- (169pt,178.1816pt) -- (5pt,178.1816pt);
            \draw[pstyle8] (169pt,178.1816pt) -- (169pt,188.1816pt) -- (179pt,188.1816pt) -- (169pt,178.1816pt);
            \node at (20pt,183.1816pt)[below right,color=black]{A new };
            \node at (63.7053pt,183.1816pt)[below right,color=black]{\textbf{FlexibilityEvent}};
            \node at (34.8606pt,199.6602pt)[below right,color=black]{ is created and will };
            \node at (41.5208pt,216.1387pt)[below right,color=black]{be considered in };
            \node at (45.3941pt,232.6172pt)[below right,color=black]{the production };
            \node at (76.5241pt,249.0957pt)[below right,color=black]{cycle};
        \end{tikzpicture}
    }
    \caption{Diagramma di sequenza che descrive la risposta dei \gls{der} ad una richiesta di flessibilit√†} \label{dg:on-request-flexibility-event}
\end{figure}
\restoregeometry