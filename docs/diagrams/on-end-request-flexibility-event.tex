\newgeometry{textwidth=0.9\paperwidth}
\begin{figure}
    \resizebox{!}{0.45\textheight}{%
        % generated by Plantuml 1.2022.7
        \definecolor{plantucolor0000}{RGB}{248,248,255}
        \definecolor{plantucolor0001}{RGB}{24,24,24}
        \definecolor{plantucolor0002}{RGB}{0,0,0}
        \definecolor{plantucolor0003}{RGB}{245,245,245}
        \definecolor{plantucolor0004}{RGB}{255,255,255}
        \definecolor{plantucolor0005}{RGB}{254,255,221}
        \begin{tikzpicture}[yscale=-1
                ,pstyle2/.style={color=plantucolor0001,fill=white,line width=1.0pt}
                ,pstyle3/.style={color=plantucolor0001,line width=0.5pt,dash pattern=on 5.0pt off 5.0pt}
                ,pstyle4/.style={fill=plantucolor0000,color=plantucolor0000,line width=0.5pt}
                ,pstyle5/.style={fill=plantucolor0003,color=plantucolor0003,line width=0.5pt}
                ,pstyle6/.style={color=plantucolor0001,fill=plantucolor0001,line width=1.0pt}
                ,pstyle7/.style={color=plantucolor0001,line width=1.0pt}
                ,pstyle8/.style={color=plantucolor0001,fill=plantucolor0005,line width=0.5pt}
            ]
            \draw[color=plantucolor0001,fill=plantucolor0000,line width=0.5pt] (77pt,6pt) rectangle (138.6pt,255.8848pt);
            \node at (80pt,6pt)[below right,color=black]{\textbf{Backend}};
            \draw[color=plantucolor0001,fill=plantucolor0003,line width=0.5pt] (272.3923pt,6pt) rectangle (359.0832pt,255.8848pt);
            \node at (279.0806pt,6pt)[below right,color=black]{\textbf{Blockchain}};
            \draw[pstyle2] (102.8pt,91.7031pt) rectangle (112.8pt,165.6602pt);
            \draw[pstyle3] (107.581pt,59.2246pt) -- (107.581pt,220.1387pt);
            \draw[pstyle3] (315.3923pt,59.2246pt) -- (315.3923pt,220.1387pt);
            \draw[pstyle4] (88.581pt,31.4785pt) arc (180:270:5pt) -- (93.581pt,26.4785pt) -- (122.019pt,26.4785pt) arc (270:360:5pt) -- (127.019pt,31.4785pt) -- (127.019pt,53.2246pt) arc (0:90:5pt) -- (122.019pt,58.2246pt) -- (93.581pt,58.2246pt) arc (90:180:5pt) -- (88.581pt,53.2246pt) -- cycle;
            \node at (95.581pt,33.4785pt)[below right,color=black]{IoT};
            \draw[pstyle4] (88.581pt,224.1387pt) arc (180:270:5pt) -- (93.581pt,219.1387pt) -- (122.019pt,219.1387pt) arc (270:360:5pt) -- (127.019pt,224.1387pt) -- (127.019pt,245.8848pt) arc (0:90:5pt) -- (122.019pt,250.8848pt) -- (93.581pt,250.8848pt) arc (90:180:5pt) -- (88.581pt,245.8848pt) -- cycle;
            \node at (95.581pt,226.1387pt)[below right,color=black]{IoT};
            \draw[pstyle5] (276.3923pt,31.4785pt) arc (180:270:5pt) -- (281.3923pt,26.4785pt) -- (350.0832pt,26.4785pt) arc (270:360:5pt) -- (355.0832pt,31.4785pt) -- (355.0832pt,53.2246pt) arc (0:90:5pt) -- (350.0832pt,58.2246pt) -- (281.3923pt,58.2246pt) arc (90:180:5pt) -- (276.3923pt,53.2246pt) -- cycle;
            \node at (283.3923pt,33.4785pt)[below right,color=black]{EW chain};
            \draw[pstyle5] (276.3923pt,224.1387pt) arc (180:270:5pt) -- (281.3923pt,219.1387pt) -- (350.0832pt,219.1387pt) arc (270:360:5pt) -- (355.0832pt,224.1387pt) -- (355.0832pt,245.8848pt) arc (0:90:5pt) -- (350.0832pt,250.8848pt) -- (281.3923pt,250.8848pt) arc (90:180:5pt) -- (276.3923pt,245.8848pt) -- cycle;
            \node at (283.3923pt,226.1387pt)[below right,color=black]{EW chain};
            \draw[pstyle2] (102.8pt,91.7031pt) rectangle (112.8pt,165.6602pt);
            \draw[pstyle6] (123.8pt,87.7031pt) -- (113.8pt,91.7031pt) -- (123.8pt,95.7031pt) -- (119.8pt,91.7031pt) -- cycle;
            \draw[pstyle7] (117.8pt,91.7031pt) -- (314.7377pt,91.7031pt);
            \node at (126.0905pt,73.2246pt)[below right,color=black]{\textbf{EndRequestFlexibilityEvent}};
            \draw[pstyle7] (112.8pt,122.1816pt) -- (154.8pt,122.1816pt);
            \draw[pstyle7] (154.8pt,122.1816pt) -- (154.8pt,135.1816pt);
            \draw[pstyle7] (113.8pt,135.1816pt) -- (154.8pt,135.1816pt);
            \draw[pstyle6] (123.8pt,131.1816pt) -- (113.8pt,135.1816pt) -- (123.8pt,139.1816pt) -- (119.8pt,135.1816pt) -- cycle;
            \node at (119.8pt,103.7031pt)[below right,color=black]{\textit{confirmProvidedFlexibility}};
            \draw[pstyle6] (303.7377pt,161.6602pt) -- (313.7377pt,165.6602pt) -- (303.7377pt,169.6602pt) -- (307.7377pt,165.6602pt) -- cycle;
            \draw[pstyle7] (107.8pt,165.6602pt) -- (309.7377pt,165.6602pt);
            \node at (144.7656pt,147.1816pt)[below right,color=black]{\textit{provideFlexibilityFair}};
            \draw[pstyle8] (5pt,178.6602pt) -- (5pt,204.6602pt) -- (211pt,204.6602pt) -- (211pt,188.6602pt) -- (201pt,178.6602pt) -- (5pt,178.6602pt);
            \draw[pstyle8] (201pt,178.6602pt) -- (201pt,188.6602pt) -- (211pt,188.6602pt) -- (201pt,178.6602pt);
            \node at (20pt,183.6602pt)[below right,color=black]{Remove the };
            \node at (95.2pt,183.6602pt)[below right,color=black]{\textbf{FlexibilityEvent}};
        \end{tikzpicture}
    }
    \caption{Diagramma di sequenza che descrive la fine della flessibilit√†} \label{dg:on-end-request-flexibility-event}
\end{figure}
\restoregeometry